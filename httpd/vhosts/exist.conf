<VirtualHost *:443>

  ## Vhost docroot
  DocumentRoot "/var/www/html"

  ## Directories, there should at least be a declaration for /var/www/html

  <Directory "/var/www/html">
    Options Indexes FollowSymlinks ExecCGI
    AllowOverride None
    Require all granted
  </Directory>

  ## Logging
  ErrorLog "/var/log/apache2/ahikar.log"
  ServerSignature Off
  CustomLog "/var/log/apache2/ahikar.log" combined

    ProxyTimeout 3000000
    RewriteEngine on
    RewriteCond %{QUERY_STRING} _query=
    RewriteRule      (.*)               $1?     [R=permanent]
    Header always set Referrer-Policy "no-referrer"

  <Location /db >
      ProxyPreserveHost Off
      ProxyPass http://existdb:8080/exist/apps/ahikar/ retry=0
      ProxyPassReverse http://existdb:8080/exist/apps/ahikar/
      Require all granted
  </Location>

  <Location /api/>
      ProxyPreserveHost Off
      ProxyPass http://existdb:8080/exist/restxq/api/ retry=0
      ProxyPassReverse http://existdb:8080/exist/restxq/api/
      Require all granted
      Header set Access-Control-Allow-Origin "*"
  </Location>

  <Location /openapi/>
      ProxyPreserveHost Off
      ProxyPass http://existdb:8080/exist/apps/openapi/ retry=0
      ProxyPassReverse http://existdb:8080/exist/apps/openapi/
      Require all granted
      Header set Access-Control-Allow-Origin "*"
  </Location>

  <Location /rest>
      ProxyPreserveHost Off
      ProxyPass http://existdb:8080/exist/rest/db/sade-projects/textgrid/data/xml retry=0
      ProxyPassReverse http://existdb:8080/exist/rest/db/sade-projects/textgrid/data/xml
      Require all granted
  </Location>

</VirtualHost>
